import{c as U,f as A,q as S,o as q,w as C,h as B,i as M,k as y,l as _,m as $,n as I,s as m,p as V,F as f,t as d,v as G,r as o}from"./index-Rlusybdb.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],et=U("calendar",j),z=async(e,t)=>{const a=A(d,f.APPLICATIONS),n={...t,userId:e,interviewNotes:[],createdAt:m(),updatedAt:m()};return(await M(a,n)).id},H=async(e,t)=>{const a=y(d,f.APPLICATIONS,e);await _(a,{...t,updatedAt:m()})},J=async e=>{const t=y(d,f.APPLICATIONS,e);await $(t)},K=async(e,t=[])=>{const a=A(d,f.APPLICATIONS),n=S(a,C("userId","==",e),...t);return(await V(n)).docs.map(r=>({id:r.id,...r.data()}))},Q=(e,t,a)=>{const n=A(d,f.APPLICATIONS),u=S(n,C("userId","==",e),q("createdAt","desc"));return B(u,r=>{const i=r.docs.map(h=>({id:h.id,...h.data()}));t(i)},a)},W=async e=>{const t=I(d);e.forEach(({id:a,data:n})=>{const u=y(d,f.APPLICATIONS,a);t.update(u,{...n,updatedAt:m()})}),await t.commit()},X=async e=>{const t=I(d);e.forEach(a=>{const n=y(d,f.APPLICATIONS,a);t.delete(n)}),await t.commit()},at=(e,t="USD")=>{const a=typeof e=="string"?parseFloat(e):e;return isNaN(a)?"":new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(a)},Y=(e,t)=>e.filter(a=>{if(t.status?.length&&!t.status.includes(a.status)||t.companies?.length&&!t.companies.includes(a.company))return!1;if(t.dateRange){const n=new Date(a.dateApplied),u=new Date(t.dateRange.start),r=new Date(t.dateRange.end);if(n<u||n>r)return!1}if(t.searchTerm){const n=t.searchTerm.toLowerCase();if(!`${a.title} ${a.company} ${a.notes||""}`.toLowerCase().includes(n))return!1}return!0}),Z=(e,t,a)=>[...e].sort((n,u)=>{let r=n[t],i=u[t];return(t==="dateApplied"||t==="createdAt"||t==="updatedAt")&&(r=new Date(r).getTime(),i=new Date(i).getTime()),typeof r=="string"&&(r=r.toLowerCase(),i=i.toLowerCase()),r<i?a==="asc"?-1:1:r>i?a==="asc"?1:-1:0}),st=e=>{const t={total:e.length,byStatus:{},responseRate:0,averageResponseTime:0,offerRate:0};e.forEach(n=>{t.byStatus[n.status]=(t.byStatus[n.status]||0)+1});const a=e.filter(n=>!["Applied","Ghosted"].includes(n.status)).length;return t.responseRate=t.total>0?a/t.total*100:0,t.offerRate=t.total>0?(t.byStatus.Offer||0)/t.total*100:0,t},nt=()=>{const{user:e}=G(),[t,a]=o.useState([]),[n,u]=o.useState([]),[r,i]=o.useState(!0),[h,l]=o.useState(null),[w,D]=o.useState({}),[g,R]=o.useState("createdAt"),[b,E]=o.useState("desc");o.useEffect(()=>{let c=Y(t,w);c=Z(c,g,b),u(c)},[t,w,g,b]),o.useEffect(()=>{if(!e){a([]),u([]),i(!1);return}return i(!0),l(null),Q(e.uid,s=>{a(s),i(!1)},s=>{l(s.message),i(!1)})},[e]);const T=o.useCallback(async c=>{if(!e)throw new Error("User not authenticated");try{return l(null),await z(e.uid,c)}catch(s){const p=s instanceof Error?s.message:"Failed to create application";throw l(p),s}},[e]),L=o.useCallback(async(c,s)=>{try{l(null),await H(c,s)}catch(p){const x=p instanceof Error?p.message:"Failed to update application";throw l(x),p}},[]),k=o.useCallback(async c=>{try{l(null),await J(c)}catch(s){const p=s instanceof Error?s.message:"Failed to delete application";throw l(p),s}},[]),P=o.useCallback(async c=>{try{l(null),await W(c)}catch(s){const p=s instanceof Error?s.message:"Failed to update applications";throw l(p),s}},[]),N=o.useCallback(async c=>{try{l(null),await X(c)}catch(s){const p=s instanceof Error?s.message:"Failed to delete applications";throw l(p),s}},[]),F=o.useCallback(async()=>{if(e)try{i(!0),l(null);const c=await K(e.uid);a(c)}catch(c){const s=c instanceof Error?c.message:"Failed to refresh applications";l(s)}finally{i(!1)}},[e]),O=o.useCallback(c=>{D(c)},[]),v=o.useCallback((c,s)=>{R(c),E(s)},[]);return{applications:t,loading:r,error:h,create:T,update:L,remove:k,batchUpdate:P,batchDelete:N,refresh:F,filter:O,sort:v,filteredApplications:n}};export{et as C,at as f,st as g,nt as u};
