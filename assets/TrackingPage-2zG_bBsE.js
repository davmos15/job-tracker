import{c as A,r as l,j as e,L as f}from"./index-QzyIvUtx.js";import{u as T,C as D,a as E,b as I,d as F}from"./useApplications-BNQgu71X.js";import{f as j,S as L,P,T as z}from"./dateUtils-CrU7KHVd.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],H=A("map-pin",q),_=()=>{const{applications:d,loading:y}=T(),[s,g]=l.useState(null),[r,c]=l.useState(""),[n,m]=l.useState(""),[x,u]=l.useState(new Date().toISOString().split("T")[0]),[a,p]=l.useState(null),[h,b]=l.useState(!1),N=d.filter(t=>!t.status.toLowerCase().includes("rejected")&&t.status.toLowerCase()!=="ghosted");l.useEffect(()=>{if(s){const t=d.find(i=>i.id===s.id);t&&g(t)}},[d,s]);const v=t=>{const i=d.find(C=>C.id===t);g(i||null),o()},o=()=>{c(""),m(""),u(new Date().toISOString().split("T")[0]),p(null)},w=t=>{p(t),c(t.type),m(t.notes),u(t.date)},S=async()=>{if(!(!s||!r.trim()||!n.trim())){b(!0);try{if(a)await E(s.id,a.id,{type:r.trim(),notes:n.trim(),date:x});else{const t={type:r.trim(),notes:n.trim(),date:x};await I(s.id,t)}o()}catch(t){console.error("Error saving stage note:",t)}finally{b(!1)}}},k=async t=>{if(!(!s||!window.confirm("Are you sure you want to delete this stage note?")))try{await F(s.id,t),a&&a.id===t&&o()}catch(i){console.error("Error deleting stage note:",i)}};return y?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(f,{size:"lg"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Job Tracking"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Track interview progress and add stage-specific notes"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Application"}),N.length===0?e.jsx("p",{className:"text-gray-500",children:"No active applications to track. Add some applications first!"}):e.jsxs("select",{value:s?.id||"",onChange:t=>v(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select an application to track..."}),N.map(t=>e.jsxs("option",{value:t.id,children:[t.title," at ",t.company," (",t.status,")"]},t.id))]})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Tracking: ",s.title," at ",s.company]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:["Applied: ",j(s.dateApplied)]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{children:["Status: ",s.status]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:a?"Edit Stage Note":"Add New Stage Note"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stage-title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Stage/Interview Type"}),e.jsx("input",{type:"text",id:"stage-title",value:r,onChange:t=>c(t.target.value),placeholder:"e.g., Phone Call, Technical Interview, HR Interview",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stage-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",id:"stage-date",value:x,onChange:t=>u(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stage-notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes & Details"}),e.jsx("textarea",{id:"stage-notes",value:n,onChange:t=>m(t.target.value),rows:4,placeholder:"Add detailed notes about this stage: questions asked, your responses, feedback received, next steps, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:S,disabled:!r.trim()||!n.trim()||h,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[h?e.jsx(f,{size:"sm",className:"mr-2"}):e.jsx(L,{className:"w-4 h-4 mr-2"}),a?"Update Note":"Add Note"]}),a&&e.jsx("button",{onClick:o,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel Edit"})]})]})]}),s.interviewNotes&&s.interviewNotes.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Stage History (",s.interviewNotes.length,")"]}),e.jsx("div",{className:"space-y-4",children:s.interviewNotes.sort((t,i)=>new Date(i.date).getTime()-new Date(t.date).getTime()).map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 capitalize",children:t.type}),e.jsx("p",{className:"text-sm text-gray-500",children:j(t.date)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>w(t),className:"text-blue-600 hover:text-blue-800",title:"Edit note",children:e.jsx(P,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k(t.id),className:"text-red-600 hover:text-red-800",title:"Delete note",children:e.jsx(z,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:t.notes})]},t.id))})]})]})]})};export{_ as default};
